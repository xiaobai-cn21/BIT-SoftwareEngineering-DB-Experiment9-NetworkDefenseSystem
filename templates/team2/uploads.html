<!-- templates/upload.html -->
<!doctype html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>上传新文件</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script>
        function updateFormFields() {
            const category = document.getElementById('category').value;
            const studentFields = document.getElementById('student-fields');
            const teacherFields = document.getElementById('teacher-fields');

            // 隐藏所有条件字段
            studentFields.style.display = 'none';
            teacherFields.style.display = 'none';

            // 显示对应的条件字段
            if (['开题资料', '中期资料', '答辩资料', '学位论文'].includes(category)) {
                studentFields.style.display = 'block';
            } else if (category === '专利资料') {
                teacherFields.style.display = 'block';
            }
        }
    </script>
</head>
<body>

    <header>
            <div class="logo-container">
                <img src="{{ url_for('static', filename='images/bit_logo.png') }}" class="school-logo">
            </div>

            <div class="menu-container">
                <div class="option-container">

                </div>

                <div class="menu">
                    <ul class="nav">
                    <li><a href="#">首页</a></li>
                    <li>
                        <a>关于我们</a>
                        <ul>
                        <li><a href="#">研究所简介</a></li>
                        <li>
                            <a>师资队伍</a>
                            <ul>
                            <li><a href=#>全职教师</a></li>
                            <li><a href=#>兼职教师</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#">学生信息</a>
                            <ul>
                            <li><a href=#>在读学生</a></li>
                            <li><a href=#>毕业学生</a></li>
                            </ul>
                        </li>
                        <li><a href="#">联系我们</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#">动态消息</a>
                        <ul>
                        <li><a href="#">新闻动态</a></li>
                        <li><a href="#">通知通告</a></li>
                        <li><a href="#">学术活动</a></li>
                        </ul>
                    </li>
                    <li>
                        <a>教学科研</a>
                        <ul>
                        <li><a href=#>教学工作</a></li>
                        <li><a href=#>科研工作</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#">研究成果</a>
                        <ul>
                        <li>
                            <a href="#">教学</a>
                            <ul>
                            <li><a href=#>成果</a></li>
                            <li><a href=#>论文</a></li>
                            <li><a href=#>教材</a></li>
                            <li><a href=#>教改</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#">科研</a>
                            <ul>
                            <li><a href="#">成果</a></li>
                            <li><a href="#">论文</a></li>
                            <li><a href="#">专利</a></li>
                            <li><a href="#">著作权</a></li>
                            </ul>
                        </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#">招生信息</a>
                        <ul>
                        <li><a href="#">本科生</a></li>
                        <li><a href="#">硕士生</a></li>
                        <li><a href="#">博士生</a></li>
                        <li><a href="#">留学生</a></li>
                        </ul>
                    </li>
                    <li><a href=#>国际合作</a></li>
                    </ul>
                </div>
            </div>
        </header>


   <div class="uploads-card">
    <div class="section-title">上传新资料</div>
  <form method="post" enctype="multipart/form-data" class="upload-form" id="uploadForm">
        <!-- 文件选择 -->
        <div class="form-group">
            <label for="fileInput">选择文件：</label>
            <input type="file" name="file" id="fileInput" required>
        </div>

        <!-- 文件类型选择 -->
        <div class="form-group">
            <label for="fileType">文件类型：</label>
            <select name="file_type" id="fileType" required>
                <option value="">-- 请选择文件类型 --</option>
                <option value="pdf">PDF</option>
                <option value="docx">Word文档</option>
                <option value="xlsx">Excel表格</option>
                <option value="pptx">PPT演示</option>
                <option value="image">图片</option>
                <option value="other">其他</option>
            </select>
        </div>

        <!-- 分类选择 -->
        <div class="form-group">
            <label for="categorySelect">资料分类：</label>
            <select name="category" id="categorySelect" required onchange="updateFormFields()">
                <option value="">-- 请选择分类 --</option>
                <option value="开题资料">开题资料</option>
                <option value="中期资料">中期资料</option>
                <option value="答辩资料">答辩资料</option>
                <option value="学位论文">学位论文</option>
                <option value="专利资料">专利资料</option>
                <option value="会议资料">会议资料</option>
                <option value="上级文件">上级文件</option>
                <option value="其他资料">其他资料</option>
            </select>
        </div>

        <!-- 学生信息字段 -->
        <div id="studentFields" class="form-group" style="display: none;">
            <input type="text" name="name" id="studentName" placeholder="姓名"
                   pattern="[\u4e00-\u9fa5]{2,10}" title="请输入2-10个中文字符">
            <input type="text" name="student_id" id="studentId" placeholder="学号"
                   pattern="[0-9]{8,12}" title="请输入8-12位数字">
        </div>

        <!-- 教师信息字段 -->
        <div id="teacherFields" class="form-group" style="display: none;">
            <input type="text" name="name" id="teacherName" placeholder="姓名"
                   pattern="[\u4e00-\u9fa5]{2,10}" title="请输入2-10个中文字符">
            <input type="text" name="teacher_id" id="teacherId" placeholder="工号"
                   pattern="[A-Za-z0-9]{6,10}" title="请输入6-10位字母或数字">
        </div>

        <input type="submit" value="上传">
    </form>
</div>




</div>

<script>
function updateFormFields() {
    const category = document.getElementById('categorySelect').value;
    const studentFields = document.getElementById('studentFields');
    const teacherFields = document.getElementById('teacherFields');

    // 重置所有字段
    studentFields.style.display = 'none';
    teacherFields.style.display = 'none';
    document.getElementById('studentName').removeAttribute('required');
    document.getElementById('studentId').removeAttribute('required');
    document.getElementById('teacherName').removeAttribute('required');
    document.getElementById('teacherId').removeAttribute('required');

    // 根据分类设置必填字段
    if (['开题资料', '中期资料', '答辩资料', '学位论文'].includes(category)) {
        studentFields.style.display = 'block';
        document.getElementById('studentName').setAttribute('required', '');
        document.getElementById('studentId').setAttribute('required', '');
    } else if (category === '专利资料') {
        teacherFields.style.display = 'block';
        document.getElementById('teacherName').setAttribute('required', '');
        document.getElementById('teacherId').setAttribute('required', '');
    }
}

// 表单提交验证
document.getElementById('uploadForm').addEventListener('submit', function(e) {
    const category = document.getElementById('categorySelect').value;

    // 验证分类相关字段
    if (['开题资料', '中期资料', '答辩资料', '学位论文'].includes(category)) {
        if (!document.getElementById('studentName').value || !document.getElementById('studentId').value) {
            alert('请填写姓名和学号');
            e.preventDefault();
            return false;
        }
    } else if (category === '专利资料') {
        if (!document.getElementById('teacherName').value || !document.getElementById('teacherId').value) {
            alert('请填写姓名和工号');
            e.preventDefault();
            return false;
        }
    }

    // 验证文件类型是否选择
    if (!document.getElementById('fileType').value) {
        alert('请选择文件类型');
        e.preventDefault();
        return false;
    }

    return true;
});
</script>


</body>
</html>